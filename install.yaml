# Details about the install.yaml file are at https://ddev.readthedocs.io/en/latest/users/extend/additional-services/#sections-and-features-of-ddev-get-add-on-installyaml

name: ddev-wordpress

# pre_install_actions - list of actions to run before installing the addon.
# Examples would be removing an extraneous docker volume,
# or doing a sanity check for requirements.
# DDEV environment variables can be interpolated into these actions
pre_install_actions:
  - rm -rf ~/.ddev/wordpress
  - mkdir ~/.ddev/wordpress
  - rm -f ~/.ddev/commands/host/wordpress
  #- rm wp-config*.php
  # Actions with #ddev-nodisplay will not show the execution of the action, but may show their output
# - |
# #ddev-nodisplay
#ddev-description:Check architecture type for incompatible arm64 type
# if [ "$(uname -m)" = "arm64" -o "$(uname -m)" = "aarch64" ]; then
# echo "This package does not work on arm64 (Apple Silicon) machines";
# exit 1;
#fi

# list of files and directories listed that are copied into project .ddev directory
# Each file should contain #ddev-generated so it can be replaced by a later `ddev get`
# if it hasn't been modified by the user.
# DDEV environment variables can be interpolated into these filenames
# If you use directories, they must be directories that are managed
# by this add-on, or removal could remove things that are not owned by it
project_files:
  # - commands/web/wordpress
# List of files and directories that are copied into the global .ddev directory
# DDEV environment variables can be interpolated into these filenames
global_files:
  #- commands/host/wordpress
  - traefik/static_config.rewrite_urls.yaml
  - wordpress/dynamic_config.middlewares.yaml
  #- wordpress/wp-config.php
  - wordpress/wp-config-development.php

# List of add-on names that this add-on depends on
dependencies:
# - redis

# DDEV environment variables can be interpolated into these actions
post_install_actions:
  #- ddev delete -O -y
  #- ddev restart -y
  #- rm -f ~/.ddev/commands/host/wordpress
  #- ln -s ~/tool-dev/ddev-wordpress/commands/host/wordpress ~/.ddev/commands/host

# Shell actions that can be done during removal of the add-on
removal_actions:
  # - rm ~/.ddev/commands/web/somecommand
  - rm -rf ~/.ddev/wordpress
  - rm -f ~/.ddev/commands/host/wordpress

# Advanced usage - yaml files can be read in and then used as go template actions
# in pre_install_actions and post_install_actions
# See example in
# https://github.com/rfay/ddev/blob/20220606_yaml_read_experiment/cmd/ddev/cmd/testdata/TestCmdGetComplex/recipe/install.yaml
yaml_read_files:
# someyaml: someyaml.yaml
# otheryaml: someotheryaml.yaml
